"0","predict_period <- function(previous, current){"
"0","  previous <- coredata(previous)"
"0","  current <- coredata(current)"
"0","  "
"0","  params <- estim_params( previous[ (length(previous)/2) : length(previous)])"
"0","  #print(params)"
"0","  "
"0","  u <- params[1]"
"0","  d <- params[2]"
"0","  p <- params[3]"
"0","  q <- params[4]"
"0","  n <- length(current)"
"0","  prices <- log(current)"
"0","  log_exp <- prices[1] + log(u)*expected_maximum_sym(p, q, n)"
"0","  log_delta <- n/4 * (log(u) + log(d))"
"0","  exp_max <- log_exp + log_delta"
"0","  "
"0","  if (!is.na(exp_max)){"
"0","  if (max(prices) < exp_max){"
"0","        #print(c(prices[n], max(prices), min(prices), exp_max))"
"0","        return(c(prices[n], max(prices), min(prices), exp_max))"
"0","  }"
"0","  "
"0","  for (price in current){"
"0","      if (price >= exp_max - 0.5){"
"0","        return(c(price, max(prices), min(prices), exp_max))}}}"
"0","  else{"
"0","    return(c(NA, NA, NA, NA))}"
"0","}"
