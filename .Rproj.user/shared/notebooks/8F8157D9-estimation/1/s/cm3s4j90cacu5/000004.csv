"0","estim_params <- function(monthly_data){"
"0","  ups <- 1"
"0","  downs <- 1"
"0","  up.days <- 0"
"0","  down.days <- 0"
"0","  "
"0","  n <- length(monthly_data)"
"0","  previous <-monthly_data[1]"
"0","  "
"0","  "
"0","  for (current in monthly_data[2:n]){"
"0","    x <- current/previous"
"0","    "
"0","  "
"0","    if (x >0 & x < 1) {"
"0","      downs = downs * x"
"0","      down.days = down.days + 1"
"0","     "
"0","    }"
"0","    if (x > 1){"
"0","      "
"0","      ups = ups * x"
"0","      up.days = up.days + 1"
"0","    }"
"0","    if (x == 1){"
"0","      print(""no price change"")"
"0","      n = n - 1"
"0","    }"
"0","    previous = current"
"0","  }"
"0","  "
"0","  "
"0","  up <- ups ^ (1/up.days)"
"0","  down <- downs ^ (1/down.days)"
"0","  "
"0","  p <- up.days / (n-1) # p to go up"
"0","  "
"0","  return(c(up, down, p, 1-p))"
"0","} "
"0","for (group in splitted_3){"
"0","  #cat(""parameters u d p q"", estim_params(coredata(data)))"
"0","}"
